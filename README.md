# AdaptMC

## Generate Figure 2
The generation of Figure 2 requires the execution of the following code, contained in the `stability.m` file. 

```matlab
clear; clc;
% Definition of symbolic variables
syms Khh Khl Kll Klh real
syms z

% Dynamic matrix of AdaptMC
A = [zeros(2,2), eye(2);
     -Khh, -Khl,   1, 0;
        0, -Kll,-Klh, 1];
 
% Computation of the characteristic polynomial
p = charpoly(A,z);

% Extraction of the coefficient of the characteristic polynomial
c1 = coeffs(p,z);
c2 = c1(end:-1:1);  % Reordering the coefficients

% Computation of the Jury chart
[J,C] = jury(c2)
```

The variable `C` contains the coefficients "of interest", i.e., the entries of the first column with uneven row-indices. `J` contains the whole Jury chart.

>**Theoreom**
>The eigenvalues of the matrix `A` lie in the unit circle if and only if the coefficients in `C` are greater than zero. Moreover, if non of these is zero, then the number of negative entries gives the number of roots outside the unit disc.


The `jury.m` function is not part of the standard library of Matlab, or of the Control System Toolbox, but it can be found at [this link](https://se.mathworks.com/matlabcentral/fileexchange/13904-jury).

Plugging the coefficients of `C` in a symbolic manipulation tool, allow the calculation. In order to obtain Figure 2, we used Wolfram Mathematica, but a Computable Document Format is also provided.

## Generate Figure 5
In order to generate Figure 5, execute the function `generateFigure5.m`. There is a toggle variable `SAVE`, that if set to 1, saves the data generated by the script. The script makes use of the function `csvwrite_with_headers`, available at [this link](https://se.mathworks.com/matlabcentral/fileexchange/29933-csv-with-column-headers).

## Generate Figure 6
In order to generate Figure 6, execute the function `generateFigure6.m`. There is a toggle variable `SCENARIO` that can be used to evaluate the different systems under different disturbance scenarios:
*  Scenario 0: $\varepsilon_{\text{H}}(t) = imp(t-10)$, $\varepsilon_{\text{L}}(t) = -imp(t-50)$

* Scenario 1: $\varepsilon_{\text{H}}(t) = sca(t-10)$, $\varepsilon_{\text{L}}(t) = -sca(t-50)$

* Scenario 2: $\varepsilon_{\text{H}}(t) = \min(0.1 ram(t-10),1)$, $\varepsilon_{\text{L}}(t) = -\min(0.1 ram(t-50),1)$

* Scenario 3: $\varepsilon_{\text{H}}(t) = imp(t-10) + 0.1 ram(t-60) (sca(t-60) -sca(t-80))$, $\varepsilon_{\text{L}}(t) = -sca(t-40)$

* Scenario 4: $\varepsilon_{\text{H}}(t) = imp(t-10) + sca(t-30) - sca(t-50) + \min(0.2 ram(t-65),3)$, $\varepsilon_{\text{L}}(t) = 0$

* Scenario 5: $\varepsilon_{\text{H}}(t) = (-1)^{t} sca(t-10)$, $\varepsilon_{\text{L}}(t) = (-1)^{t+1} sca(t-10)$


Scenario 1 generates Figure 6.

There is also a toggle variable `SAVE`, that if set to $1$, saves the data generated by the script.